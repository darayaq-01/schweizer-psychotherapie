---
import { Image } from 'astro:assets';
import Layout from '@layouts/Layout.astro';
import ImgEirka from '@assets/erika.webp';
import Container from '@components/Container.astro';

const response = await fetch('https://graphql.datocms.com/', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        Accept: 'application/json',
        Authorization: `Bearer ${import.meta.env.DATOCMS_API_KEY}`,
    },
    body: JSON.stringify({
        query: `query Homepage {
            ueberMich {
                title,
                 aboutUs {
                    value 
                    },
                imageAboutMe {
                  id
                  url
                  alt
                }
            }
          }
      `,
    }),
});

const json = await response.json();
const data = json.data.ueberMich;
const text = json.data.ueberMich.aboutUs.value.document.children.map(
    (item: { children: { value: any }[] }) => {
        return item.children[0].value;
    }
);
---

<Layout title='Ãœber mich' description='Erika Schweizer - Psychoterapeuten'>
    <Container
        title={data.title}
        className='flex flex-col md:flex-row justify-start xl:max-w-svw '
    >
        <figure class='aspect-auto justify-start'>
            <Image
                src={data.imageAboutMe.url}
                inferSize={true}
                alt={data.imageAboutMe.alt}
                class='object-cover w-full lg:max-w-72 flex-1'
            />
        </figure>
        <div class='prose'>
            {
                text.map((item: unknown) => {
                    return <p>{item}</p>;
                })
            }
        </div>
    </Container>
</Layout>
